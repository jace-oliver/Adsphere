"use client";

import { useState } from "react";

export default function UploadPage() {
  const [status, setStatus] = useState<string | null>(null);

  async function onSubmit(e: React.FormEvent<HTMLFormElement>) {
    e.preventDefault();
    const form = new FormData(e.currentTarget);
    const payload = {
      title: String(form.get("title") || ""),
      creator: String(form.get("creator") || ""),
      url: String(form.get("url") || ""),
      island: String(form.get("island") || "entertainment"),
    };

    if (!payload.title || !payload.creator || !payload.url) {
      setStatus("Please fill all fields.");
      return;
    }

    setStatus("Uploading...");
    const res = await fetch("/api/ads", {
      method: "POST",
      headers: { "content-type": "application/json" },
      body: JSON.stringify(payload),
    });
    const data = await res.json();
    if (res.ok) setStatus("Created! It should appear on the sphere.");
    else setStatus("Error: " + (data.error || "unknown"));
  }

  return (
    <div className="min-h-screen bg-white text-black p-6">
      <h1 className="text-2xl font-bold mb-4">Submit an Ad</h1>
      <form onSubmit={onSubmit} className="space-y-4 max-w-md">
        <div>
          <label className="block text-sm font-medium mb-1">Title</label>
          <input name="title" className="w-full border rounded px-3 py-2" placeholder="My Short Film" />
        </div>
        <div>
          <label className="block text-sm font-medium mb-1">Creator / Brand</label>
          <input name="creator" className="w-full border rounded px-3 py-2" placeholder="Denali Studio" />
        </div>
        <div>
          <label className="block text-sm font-medium mb-1">Link (URL)</label>
          <input name="url" className="w-full border rounded px-3 py-2" placeholder="https://example.com/watch" />
        </div>
        <div>
          <label className="block text-sm font-medium mb-1">Island</label>
          <select name="island" className="w-full border rounded px-3 py-2">
            <option value="entertainment">Entertainment Nation</option>
            <option value="product">Product Peninsula</option>
            <option value="clothing">Clothing Continent</option>
          </select>
        </div>
        <button className="px-4 py-2 rounded bg-black text-white">Submit</button>
        {status && <div className="text-sm text-gray-600">{status}</div>}
      </form>
    </div>
  );
}
